<!DOCTYPE HTML>
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (11.0.2) on Tue Jul 23 09:25:21 PDT 2024 -->
<title>ClusterNodesShuffler (Platform SDK Java 9.0 API Reference)</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="dc.created" content="2024-07-23">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../jquery/jquery-ui.css" title="Style">
<script type="text/javascript" src="../../../../../script.js"></script>
<script type="text/javascript" src="../../../../../jquery/jszip/dist/jszip.min.js"></script>
<script type="text/javascript" src="../../../../../jquery/jszip-utils/dist/jszip-utils.min.js"></script>
<!--[if IE]>
<script type="text/javascript" src="../../../../../jquery/jszip-utils/dist/jszip-utils-ie.min.js"></script>
<![endif]-->
<script type="text/javascript" src="../../../../../jquery/jquery-3.3.1.js"></script>
<script type="text/javascript" src="../../../../../jquery/jquery-migrate-3.0.1.js"></script>
<script type="text/javascript" src="../../../../../jquery/jquery-ui.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="ClusterNodesShuffler (Platform SDK Java 9.0 API Reference)";
        }
    }
    catch(err) {
    }
//-->
var data = {"i0":10,"i1":10,"i2":10,"i3":10,"i4":10,"i5":10};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
var pathtoroot = "../../../../../";
var useModuleDirectories = true;
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<header role="banner">
<nav role="navigation">
<div class="fixedNav">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a id="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/ClusterNodesShuffler.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
<div class="aboutLanguage"><b>Platform SDK Java 9.0 API Reference</b></div>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<ul class="navListSearch">
<li><label for="search">SEARCH:</label>
<input type="text" id="search" value="search" disabled="disabled">
<input type="reset" id="reset" value="reset" disabled="disabled">
</li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
</div>
<div class="navPadding">&nbsp;</div>
<script type="text/javascript"><!--
$('.navPadding').css('padding-top', $('.fixedNav').css("height"));
//-->
</script>
</nav>
</header>
<!-- ======== START OF CLASS DATA ======== -->
<main role="main">
<div class="header">
<div class="subTitle"><span class="packageLabelInType">Package</span>&nbsp;<a href="package-summary.html">com.genesyslab.platform.clusterprotocol.lb</a></div>
<h2 title="Class ClusterNodesShuffler" class="title">Class ClusterNodesShuffler</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>com.genesyslab.platform.clusterprotocol.lb.ClusterNodesShuffler</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd><code><a href="../../commons/timer/TimerAction.html" title="interface in com.genesyslab.platform.commons.timer">TimerAction</a></code>, <code>java.lang.Runnable</code></dd>
</dl>
<hr>
<pre>public class <span class="typeNameLabel">ClusterNodesShuffler</span>
extends java.lang.Object
implements java.lang.Runnable, <a href="../../commons/timer/TimerAction.html" title="interface in com.genesyslab.platform.commons.timer">TimerAction</a></pre>
<div class="block">Helper component for doing cluster load balancing from client type applications.
 It allows applications to work with servers cluster without creation of live connections
 to all of its nodes.<br/>
 This option may be critical in case of tens of thousands clients.
 <p/>
 This component uses existing functionality of ClusterProtocol to update its nodes configuration.
 ClusterProtocol allows dynamic change of nodes configuration:<ul>
 <li>Newly added nodes will get new instance of usual PSDK protocol class.
 And its asynchronous open will be started. Node will be added to the load balancer
 right after its connection.</li>
 <li>Removed nodes will be immediately excluded from the load balancer, and scheduled for closing
 after its protocol timeout delay. It will help with delivery of responses on already started requests.</li></ul>
 The randomizer uses java "Collections.shuffle(nodes)" method to randomize sequence of given nodes.<br/>
 To update protocol nodes configuration it uses round-robin rotation over randomly sorted
 whole list of the cluster nodes, choosing subset of given number of elements.<br/>
 Rotating by one node in the subset, and using more than one connection allows protocol
 to do not break all active connections at a single moment,
 and to keep online at the cluster protocol "switchover"s.
 <p/>
 The randomizer component will have optional ability to attach truncated nodes' endpoints
 as backup endpoints for selected ones. It will allow internal WarmStandby service to "switch over"
 unresponsive node faster.
 <code><pre>
 final List&lt;WSConfig&gt; nodes = ...;
 final UcsClusterProtocol ucsNProtocol =
         new UcsClusterProtocolBuilder()
                 .build();

 ucsNProtocol.setClientName("MyClientName");
 ucsNProtocol.setClientApplicationType("MyAppType");

 ClusterNodesShuffler shuffler = new ClusterNodesShuffler(ucsNProtocol, 2);
 TimerActionTicket shufflerTimer = null;

 try {
     shuffler.setNodes(nodes);
     ucsNProtocol.open();
     shufflerTimer = TimerFactory.getTimer().schedule(3000, 3000, shuffler);

     // do the business logic on the cluster protocol...
     for (int i = 0; i < 200; i++) {
         EventGetVersion resp = (EventGetVersion) ucsNProtocol.request(RequestGetVersion.create());
         System.err.println("Resp from: " + resp.getEndpoint());
         Thread.sleep(300);
     }
 } finally {
     if (shufflerTimer != null) {
         shufflerTimer.cancel();
         shufflerTimer = null;
     }
     ucsNProtocol.close();
 }
 </pre></code></div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../ClusterProtocol.html" title="interface in com.genesyslab.platform.clusterprotocol"><code>ClusterProtocol</code></a></dd>
</dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Constructor</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr class="altColor">
<th class="colConstructorName" scope="row"><code><span class="memberNameLink"><a href="#%3Cinit%3E(com.genesyslab.platform.clusterprotocol.ClusterProtocol,int)">ClusterNodesShuffler</a></span>&#8203;(<a href="../ClusterProtocol.html" title="interface in com.genesyslab.platform.clusterprotocol">ClusterProtocol</a>&nbsp;protocol,
                    int&nbsp;activeNodes)</code></th>
<td class="colLast">
<div class="block">Creates nodes shuffler for the given Cluster Protocol instance.</div>
</td>
</tr>
</table>
</li>
</ul>
</section>
<!-- ========== METHOD SUMMARY =========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Method</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#onTimer()">onTimer</a></span>()</code></th>
<td class="colLast">
<div class="block">Performs single rotation of the selected cluster nodes.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#rotateNodes()">rotateNodes</a></span>()</code></th>
<td class="colLast">
<div class="block">Performs single rotation of the selected cluster nodes.<br/>
 This operation is designed to be executed as periodical task <code>Runnable</code>.<a href="#run()"><code>run()</code></a>
 or <a href="../../commons/timer/TimerAction.html" title="interface in com.genesyslab.platform.commons.timer"><code>TimerAction</code></a>.<a href="#onTimer()"><code>onTimer()</code></a>, though, may be used directly
 in case of application specific needs.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#run()">run</a></span>()</code></th>
<td class="colLast">
<div class="block">Performs single rotation of the selected cluster nodes.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>protected void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#setActiveNodes()">setActiveNodes</a></span>()</code></th>
<td class="colLast">
<div class="block">Combines "active nodes" list and passes it to the cluster protocol for appliance.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#setNodes(java.util.Collection)">setNodes</a></span>&#8203;(java.util.Collection&lt;<a href="../../standby/WSConfig.html" title="class in com.genesyslab.platform.standby">WSConfig</a>&gt;&nbsp;nodes)</code></th>
<td class="colLast">
<div class="block">Sets the whole cluster nodes list for selections and rotations.<br/>
 It shuffles given list, selects "active" nodes subset,
 and pushes it to the protocol for appliance.</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#setUseBackups(boolean)">setUseBackups</a></span>&#8203;(boolean&nbsp;useBackups)</code></th>
<td class="colLast">
<div class="block">Enables or disables adding to the selected nodes other ones endpoints as backups.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a id="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a id="&lt;init&gt;(com.genesyslab.platform.clusterprotocol.ClusterProtocol,int)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>ClusterNodesShuffler</h4>
<pre>public&nbsp;ClusterNodesShuffler&#8203;(<a href="../ClusterProtocol.html" title="interface in com.genesyslab.platform.clusterprotocol">ClusterProtocol</a>&nbsp;protocol,
                            int&nbsp;activeNodes)</pre>
<div class="block">Creates nodes shuffler for the given Cluster Protocol instance.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>protocol</code> - the cluster protocol reference.</dd>
<dd><code>activeNodes</code> - number of active cluster nodes to pass to the protocol.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.IllegalArgumentException</code> - if given protocol reference is <code>null</code>,
     or number of active nodes is not a positive value.</dd>
</dl>
</li>
</ul>
</li>
</ul>
</section>
<!-- ============ METHOD DETAIL ========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a id="setUseBackups(boolean)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setUseBackups</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;setUseBackups&#8203;(boolean&nbsp;useBackups)</pre>
<div class="block">Enables or disables adding to the selected nodes other ones endpoints as backups.
 If its enabled, it allows internal WarmStandby service to work around unresponsive nodes
 without waiting for a next rotation(s).<br/>
 Its enabled by default.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>useBackups</code> - </dd>
</dl>
</li>
</ul>
<a id="setNodes(java.util.Collection)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setNodes</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;setNodes&#8203;(java.util.Collection&lt;<a href="../../standby/WSConfig.html" title="class in com.genesyslab.platform.standby">WSConfig</a>&gt;&nbsp;nodes)</pre>
<div class="block">Sets the whole cluster nodes list for selections and rotations.<br/>
 It shuffles given list, selects "active" nodes subset,
 and pushes it to the protocol for appliance.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>nodes</code> - the whole list of cluster nodes configurations.</dd>
</dl>
</li>
</ul>
<a id="setActiveNodes()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setActiveNodes</h4>
<pre class="methodSignature">protected&nbsp;void&nbsp;setActiveNodes()</pre>
<div class="block">Combines "active nodes" list and passes it to the cluster protocol for appliance.</div>
</li>
</ul>
<a id="run()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>run</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;run()</pre>
<div class="block">Performs single rotation of the selected cluster nodes.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code>run</code>&nbsp;in interface&nbsp;<code>java.lang.Runnable</code></dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="#rotateNodes()"><code>rotateNodes()</code></a></dd>
</dl>
</li>
</ul>
<a id="onTimer()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>onTimer</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;onTimer()</pre>
<div class="block">Performs single rotation of the selected cluster nodes.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../commons/timer/TimerAction.html#onTimer()">onTimer</a></code>&nbsp;in interface&nbsp;<code><a href="../../commons/timer/TimerAction.html" title="interface in com.genesyslab.platform.commons.timer">TimerAction</a></code></dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="#rotateNodes()"><code>rotateNodes()</code></a></dd>
</dl>
</li>
</ul>
<a id="rotateNodes()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>rotateNodes</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;rotateNodes()</pre>
<div class="block">Performs single rotation of the selected cluster nodes.<br/>
 This operation is designed to be executed as periodical task <code>Runnable</code>.<a href="#run()"><code>run()</code></a>
 or <a href="../../commons/timer/TimerAction.html" title="interface in com.genesyslab.platform.commons.timer"><code>TimerAction</code></a>.<a href="#onTimer()"><code>onTimer()</code></a>, though, may be used directly
 in case of application specific needs.</div>
</li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
</div>
</main>
<!-- ========= END OF CLASS DATA ========= -->
<footer role="contentinfo">
<nav role="navigation">
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a id="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/ClusterNodesShuffler.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
<div class="aboutLanguage"><b>Platform SDK Java 9.0 API Reference</b></div>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</nav>
<p class="legalCopy"><small>Send comments on this topic<a href=mailto:Techpubs.webadmin@genesys.com?subject=Platform%20SDK%209.0%20Documentation>Techpubs.webadmin@genesys.com.</a><br/>Document version: 9.0.010.00<br/>Copyright &copy; 2006&ndash;2023 Genesys Telecommunications Laboratories, Inc. All rights reserved.</small></p>
</footer>
</body>
</html>
